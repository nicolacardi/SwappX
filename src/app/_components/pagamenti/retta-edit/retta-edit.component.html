<div class="container">
    <mat-card class="form-cardRette data-form">
        <mat-card-content>
                <div class="buttonsDetail">
                    <button mat-stroked-button color="secondary" mat-dialog-close>
                        <mat-icon>arrow_back</mat-icon>
                        <div class="button-textDetail">
                            back
                        </div>
                    </button>

                    <button mat-stroked-button color="secondary" 
                        (click)="save()"><mat-icon>save</mat-icon>
                        <div class="button-textDetail">salva</div>
                    </button>

                </div>

            <div class="mt10" *ngIf="obsRette$ | async" >

                    <mat-form-field class="cellRettaEdit" appearance="outline">
                        <mat-label>anno scolastico</mat-label>
                        <input matInput placeholder="anno scolastico" value="{{anno.annoscolastico}}" disabled>
                    </mat-form-field>

                    <mat-form-field class="cellRettaEdit" appearance="outline">
                        <mat-label>nome alunno</mat-label>
                        <input matInput placeholder="anno scolastico" value="{{alunno.nome}}" disabled>
                    </mat-form-field>

                    <mat-form-field class="cellRettaEdit" appearance="outline">
                        <mat-label>cognome alunno</mat-label>
                        <input matInput placeholder="anno scolastico" value="{{alunno.cognome}}" disabled>
                    </mat-form-field>

            </div>  
            
            <mat-grid-list [cols]="14" rowHeight="130px">
                <mat-grid-tile [colspan]=2>
                        <div>
                            <br>
                            <div class="mt10">DEFAULT</div>

                            <div class="mt10">CONCORDATE</div>

                            <div class="mt10">PAGATE</div>
                        </div>
                </mat-grid-tile>

                <mat-grid-tile *ngFor="let mese of mesiArr; let i = index" >
                    <div>
                        <mat-label>{{placeholderMeseArr[i]}}</mat-label>
                        <app-rettamese-edit 
                        [inputPagamenti] ="totPagamenti[mese]"
                        [idRetta] ="idRette[mese]"
                        [indice] ="i"
                        ></app-rettamese-edit>
                    </div>
                </mat-grid-tile>
            </mat-grid-list>

            <div class="pagamenti-container cellBordered mt10">
                <app-pagamenti-list
                    [dove]="'retta-edit'" 
                    [alunnoID]="data.idAlunno"
                    [annoID]="data.idAnno"
                    >
                </app-pagamenti-list>
            </div>

            <div class="pagamento-edit-container cellBordered mt10">
                <form [formGroup] = "formRetta">
                    <mat-form-field class="form-dp">
                        <input matInput
                        required
                        formControlName = "dtPagamento"
                        [matDatepicker]= "dpDtPagamento"
                        placeholder="Data pagamento"
                        #date>
                        <mat-datepicker-toggle matSuffix [for]="dpDtPagamento"></mat-datepicker-toggle>
                        <mat-datepicker #dpDtPagamento></mat-datepicker>
                        <mat-error *ngIf="formRetta.controls.dtPagamento.errors?.required"> Campo obbligatorio</mat-error>
                    </mat-form-field>

                    <mat-form-field>
                        <input matInput type="number" required placeholder="Importo" formControlName="importo">
                        <mat-error *ngIf="formRetta.controls.importo.errors?.required"> Campo obbligatorio</mat-error>
                    </mat-form-field>

                    <mat-form-field  >
                        <mat-label>Tipo pagamento</mat-label>
                        <mat-select formControlName="tipoPagamentoID">
                            <mat-option *ngFor="let element of (tipiPagamento$ | async)" [value]="element.id">
                            {{element.descrizione}}
                            </mat-option>
                        </mat-select>
                        </mat-form-field>

                    <mat-form-field  >
                        <mat-label>Causale</mat-label>
                        <mat-select formControlName="causaleID" #causale>
                            <mat-option *ngFor="let element of (causaliPagamento$ | async)" [value]="element.id">
                            {{element.descrizione}}
                            </mat-option>
                        </mat-select>
                    </mat-form-field>
       
                    <mat-form-field  *ngIf="causale.value == 1">
                        <mat-label>MESE</mat-label>
                        <mat-select formControlName="meseRetta">
                            <mat-option *ngFor="let element of mesiArr; let i = index" [value]="element">
                            {{placeholderMeseArr[i]}}
                            </mat-option>
                        </mat-select>
                    </mat-form-field>

                    <mat-icon class="addRetta pointer">add_circle_outline</mat-icon>
                </form>
            </div>
        </mat-card-content>
    </mat-card>
</div>



